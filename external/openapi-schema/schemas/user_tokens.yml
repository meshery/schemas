tokenPage:
  allOf:
  - $ref: ../common.yml#/resultsPage
  - type: object
    properties:
      tokens:
        type: array
        items:
          $ref: '#/userToken'

userToken:
  properties:
    id:
      $ref: ../common.yml#/id
    user_id:
      $ref: ../common.yml#/id
    provider:
      $ref: ../common.yml#/provider
    access_token:
      $ref: ../common.yml#/text
    refresh_token:
      $ref: ../common.yml#/text
    name: 
      $ref: ../common.yml#/text
    purpose:
      $ref: ../common.yml#/text
    is_oauth:
      type: boolean
    created_at:
      $ref: ../common.yml#/time
    updated_at:
      $ref: ../common.yml#/time

/system/user/tokens:
    get:
      tags:
        - user tokens
      operationId: GetUserTokens
      summary: Get Tokens
      description: Get tokens associated with logged in user
      parameters:
        - $ref: ../parameters.yml#/isOAuth
        - $ref: ../parameters.yml#/page
        - $ref: ../parameters.yml#/pageSize
        - $ref: ../parameters.yml#/search
        - $ref: ../parameters.yml#/order
      responses:
        '200':
          description: user tokens
          content:
            application/json:
              schema:
                $ref: '#/tokenPage'
        '401':
          $ref: ../responses.yml#/401
        '500':
          $ref: ../responses.yml#/500
    post:
      tags:
        - user tokens
      operationId: GenerateToken
      summary: Generate token for logged in user
      description: null
      parameters:
        - $ref: ../parameters.yml#/name
        - $ref: ../parameters.yml#/purpose
      responses:
        '200':
          description: generated token
          content:
            text/plain:
              schema:
                type: string
        '400':
          $ref: ../responses.yml#/400
        '401':
          $ref: ../responses.yml#/401
        '500':
          $ref: ../responses.yml#/500
    delete:
      tags:
        - user tokens
      operationId: DeleteUserTokens
      summary: Delete token
      description: Delete token for logged in user
      requestBody:
        $ref: ../common.yml#/mapObject
      responses:
        '200':
          $ref: ../responses.yml#/200
        '400':
          $ref: ../responses.yml#/400
        '401':
          $ref: ../responses.yml#/401
        '500':
          $ref: ../responses.yml#/500

/system/token:
  get:
    tags:
      - user tokens
    operationId: IssueIndefiniteLifetimeToken
    summary: Infinite token
    description: Get Infinite Token
    parameters:
      - $ref: ../parameters.yml#/userId
      - $ref: ../parameters.yml#/provider
    responses:
      '200':
        description: generated token
        content:
          text/plain:
            schema:
              type: string
      '400':
          $ref: ../responses.yml#/400
      '401':
        $ref: ../responses.yml#/401
      '500':
        $ref: ../responses.yml#/500