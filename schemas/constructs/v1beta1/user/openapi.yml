openapi: 3.0.3
info:
  title: User Schema
  version: 1.0.0
paths: {}
components:
  schemas:
    User:
      type: object
      description: Represents a user in Layer5 Cloud (Meshery)
      required:
        - id
        - user_id
        - provider
        - email
        - first_name
        - last_name
        - status
        - created_at
        - updated_at
        - last_login_time
        - deleted_at
      properties:
        id:
          $ref: "../../core.json#/definitions/uuid"
          description: Unique identifier for the user
          x-go-name: ID
          x-oapi-codegen-extra-tags:
            db: "id"
            json: "id"
            yaml: "id"
        user_id:
          type: string
          maxLength: 200
          description: User identifier (username or external ID)
          x-oapi-codegen-extra-tags:
            db: "user_id"
            json: "user_id"
            yaml: "user_id"
        provider:
          type: string
          maxLength: 100
          description: "Authentication provider (e.g., Layer5 Cloud, Twitter, Facebook, Github)"
          examples:
            - local
            - github
            - google
            - twitter
          x-oapi-codegen-extra-tags:
            db: "provider"
            json: "provider"
            yaml: "provider"
        email:
          type: string
          format: email
          maxLength: 300
          description: User's email address
          x-oapi-codegen-extra-tags:
            db: "email"
            json: "email"
            yaml: "email"
        first_name:
          type: string
          maxLength: 200
          description: User's first name
          x-oapi-codegen-extra-tags:
            db: "first_name"
            json: "first_name"
            yaml: "first_name"
        last_name:
          type: string
          maxLength: 300
          description: User's last name
          x-oapi-codegen-extra-tags:
            db: "last_name"
            json: "last_name"
            yaml: "last_name"
        avatar_url:
          type: string
          format: uri
          maxLength: 500
          description: URL to user's avatar image
          x-oapi-codegen-extra-tags:
            db: "avatar_url"
            json: "avatar_url"
            yaml: "avatar_url"
        status:
          type: string
          maxLength: 100
          enum:
            - active
            - inactive
            - pending
            - anonymous
          description: User account status
          x-oapi-codegen-extra-tags:
            db: "status"
            json: "status"
            yaml: "status"
        bio:
          type: string
          maxLength: 1000
          default: ""
          description: User's biography or description
          x-oapi-codegen-extra-tags:
            db: "bio"
            json: "bio"
            yaml: "bio"
        country:
          type: object
          description: User's country information stored as JSONB
          additionalProperties: true
          x-go-type: "core.Map"
          x-oapi-codegen-extra-tags:
            db: "country"
            json: "country"
            yaml: "country"
        region:
          type: object
          description: User's region information stored as JSONB
          additionalProperties: true
          x-go-type: "core.Map"
          x-oapi-codegen-extra-tags:
            db: "region"
            json: "region"
            yaml: "region"
        preferences:
          $ref: "#/components/schemas/Preference"
          x-go-type: "Preference"
          description: User preferences stored as JSONB
          x-oapi-codegen-extra-tags:
            db: "preferences"
            json: "preferences"
            yaml: "preferences"
        accepted_terms_at:
          $ref: "../../core.json#/definitions/time"
          description: Timestamp when user accepted terms and conditions
          x-oapi-codegen-extra-tags:
            db: "accepted_terms_at"
            json: "accepted_terms_at"
            yaml: "accepted_terms_at"
        first_login_time:
          $ref: "../../core.json#/definitions/time"
          description: Timestamp of user's first login
          x-oapi-codegen-extra-tags:
            db: "first_login_time"
            json: "first_login_time"
            yaml: "first_login_time"
        last_login_time:
          $ref: "../../core.json#/definitions/time"
          description: Timestamp of user's most recent login
          x-oapi-codegen-extra-tags:
            db: "last_login_time"
            json: "last_login_time"
            yaml: "last_login_time"
        created_at:
          $ref: "../../core.json#/definitions/time"
          description: Timestamp when the user record was created
          x-oapi-codegen-extra-tags:
            db: "created_at"
            json: "created_at"
            yaml: "created_at"
        updated_at:
          $ref: "../../core.json#/definitions/time"
          description: Timestamp when the user record was last updated
          x-oapi-codegen-extra-tags:
            db: "updated_at"
            json: "updated_at"
            yaml: "updated_at"
        deleted_at:
          type: string
          format: date-time
          nullable: true
          description: Timestamp when the user record was soft-deleted (null if not deleted)
          x-go-type: "core.NullTime"
          x-oapi-codegen-extra-tags:
            db: "deleted_at"
            json: "deleted_at"
            yaml: "deleted_at"
      additionalProperties: false

    GetUserResponse:
      description: Response schema for getting user information, includes user data with roles, teams, and organizations
      allOf:
        - $ref: "#/components/schemas/User"
        - type: object
          properties:
            role_names:
              type: array
              items:
                type: string
                enum:
                  - admin
                  - meshmap
                  - curator
                  - team admin
                  - workspace admin
                  - workspace manager
                  - organization admin
                  - user
              description: List of global roles assigned to the user
              examples:
                - ["admin", "meshmap"]
                - ["user"]
              x-oapi-codegen-extra-tags:
                db: "role_names"
                json: "role_names"
                yaml: "role_names"
            teams:
              type: object
              description: Teams the user belongs to with role information
              x-oapi-codegen-extra-tags:
                db: "teams"
                json: "teams"
                yaml: "teams"
              properties:
                teams_with_roles:
                  type: array
                  items:
                    type: object
                  x-oapi-codegen-extra-tags:
                    db: "teams_with_roles"
                    json: "teams_with_roles"
                    yaml: "teams_with_roles"
                total_count:
                  type: integer
                  x-oapi-codegen-extra-tags:
                    db: "total_count"
                    json: "total_count"
                    yaml: "total_count"
            organizations:
              type: object
              description: Organizations the user belongs to with role information
              x-oapi-codegen-extra-tags:
                db: "organizations"
                json: "organizations"
                yaml: "organizations"
              properties:
                organizations_with_roles:
                  type: array
                  items:
                    type: object
                  x-oapi-codegen-extra-tags:
                    db: "organizations_with_roles"
                    json: "organizations_with_roles"
                    yaml: "organizations_with_roles"
                total_count:
                  type: integer
                  x-oapi-codegen-extra-tags:
                    db: "total_count"
                    json: "total_count"
                    yaml: "total_count"

    Preference:
      type: object
      required:
        - anonymousUsageStats
        - anonymousPerfResults
        - updatedAt
        - dashboardPreferences
        - selectedOrganizationID
        - selectedWorkspaceForOrganizations
        - usersExtensionPreferences
        - RemoteProviderPreferences

      properties:
        meshAdapters:
          type: array
          items:
            x-go-type: Adapter
            $ref: "#/components/schemas/Adapter"
        grafana:
          x-go-type: Grafana
          $ref: "#/components/schemas/Grafana"
        prometheus:
          x-go-type: Prometheus
          $ref: "#/components/schemas/Prometheus"
        loadTestPrefs:
          x-go-type: LoadTestPreferences
          $ref: "#/components/schemas/LoadTestPreferences"
        anonymousUsageStats:
          type: boolean
        anonymousPerfResults:
          type: boolean
        updated_at:
          type: string
          format: date-time
        dashboardPreferences:
          type: object
          additionalProperties: true
        selectedOrganizationID:
          type: string
        selectedWorkspaceForOrganizations:
          type: object
          additionalProperties:
            type: string
        usersExtensionPreferences:
          type: object
          additionalProperties: true
        remoteProviderPreferences:
          type: object
          additionalProperties: true

    Adapter:
      type: object
      description: Placeholder for Adapter struct definition.

    Grafana:
      type: object
      properties:
        grafanaURL:
          type: string
        grafanaAPIKey:
          type: string
        selectedBoardsConfigs:
          type: array
          items:
            $ref: "#/components/schemas/SelectedGrafanaConfig"

    SelectedGrafanaConfig:
      type: object
      properties:
        board:
          $ref: "#/components/schemas/GrafanaBoard"
        panels:
          type: array
          items:
            $ref: "#/components/schemas/Panel"
        templateVars:
          type: array
          items:
            type: string

    GrafanaBoard:
      type: object
      description: Placeholder for GrafanaBoard definition (define fields as needed)

    Panel:
      type: object
      description: Grafana panel structure imported from github.com/grafana-tools/sdk

    Prometheus:
      type: object
      properties:
        prometheusURL:
          type: string
        selectedPrometheusBoardsConfigs:
          type: array
          items:
            $ref: "#/components/schemas/SelectedGrafanaConfig"

    LoadTestPreferences:
      type: object
      properties:
        c:
          type: integer
          description: Concurrent requests
        qps:
          type: integer
          description: Queries per second
        t:
          type: string
          description: Duration
        gen:
          type: string
          description: Load generator

    Social:
      description: "Various online profiles associated with the user account, like GitHub, LinkedIn, X, and so on."
      type: object
      properties:
        site:
          type: string
          maxLength: 50
        link:
          type: string
          format: uri
      required: ["site", "link"]