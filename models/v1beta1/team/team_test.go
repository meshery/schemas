// This is not autogenerated.
package team

import (
	"database/sql"
	"encoding/json"
	"testing"
	"time"

	"github.com/gofrs/uuid"
)

func TestTeamSerialization(t *testing.T) {
	teamID := uuid.Must(uuid.NewV4())
	ownerID := uuid.Must(uuid.NewV4())
	now := time.Now()

	team := Team{
		ID:          teamID,
		Name:        "Test Team",
		Description: "A test team description",
		Owner:       ownerID,
		Metadata:    nil,
		CreatedAt:   now,
		UpdatedAt:   now,
		DeletedAt:   sql.NullTime{},
	}

	// Test JSON serialization
	jsonBytes, err := json.Marshal(team)
	if err != nil {
		t.Fatalf("Failed to marshal Team to JSON: %v", err)
	}

	var unmarshaled Team
	if err := json.Unmarshal(jsonBytes, &unmarshaled); err != nil {
		t.Fatalf("Failed to unmarshal Team from JSON: %v", err)
	}

	if unmarshaled.ID != team.ID {
		t.Errorf("ID mismatch: got %v, want %v", unmarshaled.ID, team.ID)
	}
	if unmarshaled.Name != team.Name {
		t.Errorf("Name mismatch: got %v, want %v", unmarshaled.Name, team.Name)
	}
	if unmarshaled.Owner != team.Owner {
		t.Errorf("Owner mismatch: got %v, want %v", unmarshaled.Owner, team.Owner)
	}
}

func TestTeamEventCategory(t *testing.T) {
	team := &Team{}
	if category := team.EventCategory(); category != "team" {
		t.Errorf("EventCategory() = %v, want %v", category, "team")
	}
}

func TestTeamsOrganizationsMappingEventCategory(t *testing.T) {
	mapping := &TeamsOrganizationsMapping{}
	if category := mapping.EventCategory(); category != "organization" {
		t.Errorf("EventCategory() = %v, want %v", category, "organization")
	}
}

func TestTeamPayloadSerialization(t *testing.T) {
	payload := TeamPayload{
		Name:             "New Team",
		Description:      "Team description",
		NotifyTeamUpdate: true,
		Metadata:         nil,
	}

	jsonBytes, err := json.Marshal(payload)
	if err != nil {
		t.Fatalf("Failed to marshal TeamPayload to JSON: %v", err)
	}

	var unmarshaled TeamPayload
	if err := json.Unmarshal(jsonBytes, &unmarshaled); err != nil {
		t.Fatalf("Failed to unmarshal TeamPayload from JSON: %v", err)
	}

	if unmarshaled.Name != payload.Name {
		t.Errorf("Name mismatch: got %v, want %v", unmarshaled.Name, payload.Name)
	}
	if unmarshaled.NotifyTeamUpdate != payload.NotifyTeamUpdate {
		t.Errorf("NotifyTeamUpdate mismatch: got %v, want %v", unmarshaled.NotifyTeamUpdate, payload.NotifyTeamUpdate)
	}
}

func TestTeamsPageSerialization(t *testing.T) {
	teamID := uuid.Must(uuid.NewV4())
	ownerID := uuid.Must(uuid.NewV4())

	page := TeamsPage{
		Page:       1,
		PageSize:   10,
		TotalCount: 1,
		Teams: []Team{
			{
				ID:    teamID,
				Name:  "Test Team",
				Owner: ownerID,
			},
		},
	}

	jsonBytes, err := json.Marshal(page)
	if err != nil {
		t.Fatalf("Failed to marshal TeamsPage to JSON: %v", err)
	}

	var unmarshaled TeamsPage
	if err := json.Unmarshal(jsonBytes, &unmarshaled); err != nil {
		t.Fatalf("Failed to unmarshal TeamsPage from JSON: %v", err)
	}

	if unmarshaled.TotalCount != page.TotalCount {
		t.Errorf("TotalCount mismatch: got %v, want %v", unmarshaled.TotalCount, page.TotalCount)
	}
	if len(unmarshaled.Teams) != len(page.Teams) {
		t.Errorf("Teams length mismatch: got %v, want %v", len(unmarshaled.Teams), len(page.Teams))
	}
}
